/**
 * Created by syariefa on 2/16/16.
 */
tinymce.PluginManager.add('li', function(editor, url) {
    /* Add a button that opens a window
	editor.addButton('example', {
		text: 'My button',
		icon: false,
		onclick: function() {
			// Open window
			editor.windowManager.open({
				title: 'Example plugin',
				body: [
					{type: 'textbox', name: 'title', label: 'Title'}
				],
				onsubmit: function(e) {
					// Insert content when the window form is submitted
					editor.insertContent('Title: ' + e.data.title);
				}
			});
		}
	});*/

	// Adds a menu item to the tools menu
	editor.addMenuItem('li', {
		text: 'Template LI',
		context: 'insert',
		onclick: function() {
			// Open window with a specific url
			var peran;
            var selector_peran_ke=$("span#data_peran_ke");
            var url_struktur_peran = '/perek_tugas/bantu17/data_struktur/';
            var nilai_selector_peran_ke = selector_peran_ke.attr('data-peran_ke').replace(/-/g, '');
            var nilai_selector_kode_peran_ke =$("span#data_peran_kode_ke").attr('data-peran_kode_ke');

            if(selector_peran_ke.attr('data-peran_ke').indexOf('ES') > 0)
            {peran = 'Engineering Staff'}
            else if(selector_peran_ke.attr('data-peran_ke').indexOf('LD') > 0)
            {peran = 'Leader'}
            else if(selector_peran_ke.attr('data-peran_ke').indexOf('GL') > 0)
            {peran = 'Group Leader'}
            else if(selector_peran_ke.attr('data-peran_ke').indexOf('PM') > 0)
            {peran = 'Program Manager'}
            else if(selector_peran_ke.attr('data-peran_ke').indexOf('CE') > 0)
            {peran = 'Chief Engineering'}
            else
            {peran = 'NAMA_PERAN_DISINI'}

            $.get(url_struktur_peran+$("span#da_nmr").attr('data-value'), function(nama_struktur){
                var tgl;
                var selector_tgl = $("span#data_tanggal");

                if(selector_tgl.attr('data-value') == '')
                {
                    tgl = '';
                }

                else
                {
                    tgl = 'Tanggal '+ selector_tgl.attr('data-value');
                }

                var a = '<p>Kepada Yth<br> Sdr/i '+peran+' '+nama_struktur+' ('+nilai_selector_peran_ke+ nilai_selector_kode_peran_ke+')'+'<br>Di tempat.</p>';
                a += '<p>Dengan Hormat,</p>';
                a += '<p>Menindaklanjuti Instruksi '+$("span#data_referensi").attr('data-value')+' '+tgl+',</p>';

                tinymce.activeEditor.execCommand('mceInsertContent', false, a);
            });
		}
	});
});
